{"version":3,"file":"yabh.js","sources":["../src/index.js"],"sourcesContent":["/**\n * @method bubbleUp\n * @param {array} heap The heap.\n * @param {function} weightFunc The weight function.\n * @param {number} n The index of the element to bubble up.\n */\nconst bubbleUp = function (heap, weightFunc, n) {\n  const element = heap[n]\n  const weight = weightFunc(element)\n  // When at 0, an element can not go up any further.\n  while (n > 0) {\n    // Compute the parent element's index, and fetch it.\n    let parentN = Math.floor((n + 1) / 2) - 1\n    let parent = heap[parentN]\n    // If the parent has a lesser weight, things are in order and we\n    // are done.\n    if (weight >= weightFunc(parent)) {\n      break\n    } else {\n      heap[parentN] = element\n      heap[n] = parent\n      n = parentN\n    }\n  }\n}\n\n/**\n * @method bubbleDown\n * @param {array} heap The heap.\n * @param {function} weightFunc The weight function.\n * @param {number} n The index of the element to sink down.\n */\nconst bubbleDown = function (heap, weightFunc, n) {\n  var length = heap.length\n  let node = heap[n]\n  let nodeWeight = weightFunc(node)\n\n  while (true) {\n    let child2N = (n + 1) * 2\n    let child1N = child2N - 1\n    let swap = null;\n    if (child1N < length) {\n      let child1 = heap[child1N]\n      let child1Weight = weightFunc(child1)\n      // If the score is less than our node's, we need to swap.\n      if (child1Weight < nodeWeight) {\n        swap = child1N\n      }\n    }\n    // Do the same checks for the other child.\n    if (child2N < length) {\n      let child2 = heap[child2N]\n      let child2Weight = weightFunc(child2)\n      if (child2Weight < (swap === null ? nodeWeight : weightFunc(heap[child1N]))) {\n        swap = child2N\n      }\n    }\n\n    if (swap === null) {\n      break\n    } else {\n      heap[n] = heap[swap]\n      heap[swap] = node\n      n = swap\n    }\n  }\n}\n\nfunction BinaryHeap (weightFunc, compareFunc) {\n  if (!weightFunc) {\n    weightFunc = function (x) { return x }\n  }\n  if (!compareFunc) {\n    compareFunc = function (x, y) { return x === y }\n  }\n  if (typeof weightFunc !== 'function') {\n    throw new Error('BinaryHeap([weightFunc][, compareFunc]): \"weightFunc\" must be a function!')\n  }\n  if (typeof compareFunc !== 'function') {\n    throw new Error('BinaryHeap([weightFunc][, compareFunc]): \"compareFunc\" must be a function!')\n  }\n  this.weightFunc = weightFunc\n  this.compareFunc = compareFunc\n  this.heap = []\n}\n\nlet BHProto = BinaryHeap.prototype\n\nBHProto.push = function (node) {\n  this.heap.push(node)\n  bubbleUp(this.heap, this.weightFunc, this.heap.length - 1)\n}\n\nBHProto.peek = function () {\n  return this.heap[0]\n}\n\nBHProto.pop = function () {\n  let front = this.heap[0]\n  let end = this.heap.pop()\n  if (this.heap.length > 0) {\n    this.heap[0] = end\n    bubbleDown(this.heap, this.weightFunc, 0)\n  }\n  return front\n}\n\nBHProto.remove = function (node) {\n  var length = this.heap.length\n  for (let i = 0; i < length; i++) {\n    if (this.compareFunc(this.heap[i], node)) {\n      let removed = this.heap[i]\n      let end = this.heap.pop()\n      if (i !== length - 1) {\n        this.heap[i] = end\n        bubbleUp(this.heap, this.weightFunc, i)\n        bubbleDown(this.heap, this.weightFunc, i)\n      }\n      return removed\n    }\n  }\n  return null\n}\n\nBHProto.removeAll = function () {\n  this.heap = []\n}\n\nBHProto.size = function () {\n  return this.heap.length\n}\n\nexport default BinaryHeap\n"],"names":[],"mappings":";;;;;;;;;;;;AAMA,EAAA,IAAM,WAAW,SAAX,QAAW,CAAU,IAAV,EAAgB,UAAhB,EAA4B,CAA5B,EAA+B;AAC9C,EAAA,MAAM,UAAU,KAAK,CAAL,CAAhB;AACA,EAAA,MAAM,SAAS,WAAW,OAAX,CAAf;;AAEA,EAAA,SAAO,IAAI,CAAX,EAAc;;AAEZ,EAAA,QAAI,UAAU,KAAK,KAAL,CAAW,CAAC,IAAI,CAAL,IAAU,CAArB,IAA0B,CAAxC;AACA,EAAA,QAAI,SAAS,KAAK,OAAL,CAAb;;;AAGA,EAAA,QAAI,UAAU,WAAW,MAAX,CAAd,EAAkC;AAChC,EAAA;AACD,EAAA,KAFD,MAEO;AACL,EAAA,WAAK,OAAL,IAAgB,OAAhB;AACA,EAAA,WAAK,CAAL,IAAU,MAAV;AACA,EAAA,UAAI,OAAJ;AACD,EAAA;AACF,EAAA;AACF,EAAA,CAlBD;;;;;;;;AA0BA,EAAA,IAAM,aAAa,SAAb,UAAa,CAAU,IAAV,EAAgB,UAAhB,EAA4B,CAA5B,EAA+B;AAChD,EAAA,MAAI,SAAS,KAAK,MAAlB;AACA,EAAA,MAAI,OAAO,KAAK,CAAL,CAAX;AACA,EAAA,MAAI,aAAa,WAAW,IAAX,CAAjB;;AAEA,EAAA,SAAO,IAAP,EAAa;AACX,EAAA,QAAI,UAAU,CAAC,IAAI,CAAL,IAAU,CAAxB;AACA,EAAA,QAAI,UAAU,UAAU,CAAxB;AACA,EAAA,QAAI,OAAO,IAAX;AACA,EAAA,QAAI,UAAU,MAAd,EAAsB;AACpB,EAAA,UAAI,SAAS,KAAK,OAAL,CAAb;AACA,EAAA,UAAI,eAAe,WAAW,MAAX,CAAnB;;AAEA,EAAA,UAAI,eAAe,UAAnB,EAA+B;AAC7B,EAAA,eAAO,OAAP;AACD,EAAA;AACF,EAAA;;AAED,EAAA,QAAI,UAAU,MAAd,EAAsB;AACpB,EAAA,UAAI,SAAS,KAAK,OAAL,CAAb;AACA,EAAA,UAAI,eAAe,WAAW,MAAX,CAAnB;AACA,EAAA,UAAI,gBAAgB,SAAS,IAAT,GAAgB,UAAhB,GAA6B,WAAW,KAAK,OAAL,CAAX,CAA7C,CAAJ,EAA6E;AAC3E,EAAA,eAAO,OAAP;AACD,EAAA;AACF,EAAA;;AAED,EAAA,QAAI,SAAS,IAAb,EAAmB;AACjB,EAAA;AACD,EAAA,KAFD,MAEO;AACL,EAAA,WAAK,CAAL,IAAU,KAAK,IAAL,CAAV;AACA,EAAA,WAAK,IAAL,IAAa,IAAb;AACA,EAAA,UAAI,IAAJ;AACD,EAAA;AACF,EAAA;AACF,EAAA,CAlCD;;AAoCA,EAAA,SAAS,UAAT,CAAqB,UAArB,EAAiC,WAAjC,EAA8C;AAC5C,EAAA,MAAI,CAAC,UAAL,EAAiB;AACf,EAAA,iBAAa,oBAAU,CAAV,EAAa;AAAE,EAAA,aAAO,CAAP;AAAU,EAAA,KAAtC;AACD,EAAA;AACD,EAAA,MAAI,CAAC,WAAL,EAAkB;AAChB,EAAA,kBAAc,qBAAU,CAAV,EAAa,CAAb,EAAgB;AAAE,EAAA,aAAO,MAAM,CAAb;AAAgB,EAAA,KAAhD;AACD,EAAA;AACD,EAAA,MAAI,OAAO,UAAP,KAAsB,UAA1B,EAAsC;AACpC,EAAA,UAAM,IAAI,KAAJ,CAAU,2EAAV,CAAN;AACD,EAAA;AACD,EAAA,MAAI,OAAO,WAAP,KAAuB,UAA3B,EAAuC;AACrC,EAAA,UAAM,IAAI,KAAJ,CAAU,4EAAV,CAAN;AACD,EAAA;AACD,EAAA,OAAK,UAAL,GAAkB,UAAlB;AACA,EAAA,OAAK,WAAL,GAAmB,WAAnB;AACA,EAAA,OAAK,IAAL,GAAY,EAAZ;AACD,EAAA;;AAED,EAAA,IAAI,UAAU,WAAW,SAAzB;;AAEA,EAAA,QAAQ,IAAR,GAAe,UAAU,IAAV,EAAgB;AAC7B,EAAA,OAAK,IAAL,CAAU,IAAV,CAAe,IAAf;AACA,EAAA,WAAS,KAAK,IAAd,EAAoB,KAAK,UAAzB,EAAqC,KAAK,IAAL,CAAU,MAAV,GAAmB,CAAxD;AACD,EAAA,CAHD;;AAKA,EAAA,QAAQ,IAAR,GAAe,YAAY;AACzB,EAAA,SAAO,KAAK,IAAL,CAAU,CAAV,CAAP;AACD,EAAA,CAFD;;AAIA,EAAA,QAAQ,GAAR,GAAc,YAAY;AACxB,EAAA,MAAI,QAAQ,KAAK,IAAL,CAAU,CAAV,CAAZ;AACA,EAAA,MAAI,MAAM,KAAK,IAAL,CAAU,GAAV,EAAV;AACA,EAAA,MAAI,KAAK,IAAL,CAAU,MAAV,GAAmB,CAAvB,EAA0B;AACxB,EAAA,SAAK,IAAL,CAAU,CAAV,IAAe,GAAf;AACA,EAAA,eAAW,KAAK,IAAhB,EAAsB,KAAK,UAA3B,EAAuC,CAAvC;AACD,EAAA;AACD,EAAA,SAAO,KAAP;AACD,EAAA,CARD;;AAUA,EAAA,QAAQ,MAAR,GAAiB,UAAU,IAAV,EAAgB;AAC/B,EAAA,MAAI,SAAS,KAAK,IAAL,CAAU,MAAvB;AACA,EAAA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAApB,EAA4B,GAA5B,EAAiC;AAC/B,EAAA,QAAI,KAAK,WAAL,CAAiB,KAAK,IAAL,CAAU,CAAV,CAAjB,EAA+B,IAA/B,CAAJ,EAA0C;AACxC,EAAA,UAAI,UAAU,KAAK,IAAL,CAAU,CAAV,CAAd;AACA,EAAA,UAAI,MAAM,KAAK,IAAL,CAAU,GAAV,EAAV;AACA,EAAA,UAAI,MAAM,SAAS,CAAnB,EAAsB;AACpB,EAAA,aAAK,IAAL,CAAU,CAAV,IAAe,GAAf;AACA,EAAA,iBAAS,KAAK,IAAd,EAAoB,KAAK,UAAzB,EAAqC,CAArC;AACA,EAAA,mBAAW,KAAK,IAAhB,EAAsB,KAAK,UAA3B,EAAuC,CAAvC;AACD,EAAA;AACD,EAAA,aAAO,OAAP;AACD,EAAA;AACF,EAAA;AACD,EAAA,SAAO,IAAP;AACD,EAAA,CAfD;;AAiBA,EAAA,QAAQ,SAAR,GAAoB,YAAY;AAC9B,EAAA,OAAK,IAAL,GAAY,EAAZ;AACD,EAAA,CAFD;;AAIA,EAAA,QAAQ,IAAR,GAAe,YAAY;AACzB,EAAA,SAAO,KAAK,IAAL,CAAU,MAAjB;AACD,EAAA,CAFD;;;;"}